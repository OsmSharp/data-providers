
CREATE TABLE NODE
(
  ID            NUMBER(11)                      NOT NULL,
  LATITUDE      NUMBER(11)                      NOT NULL,
  LONGITUDE     NUMBER(11)                      NOT NULL,
  CHANGESET_ID  NUMBER(11)                      NOT NULL,
  VISIBLE       NUMBER(1)                       NOT NULL,
  TIMESTAMP     DATE                            NOT NULL,
  TILE          NUMBER(11)                      NOT NULL,
  VERSION       NUMBER(11)                      NOT NULL,
  USR           VARCHAR2(255 BYTE),
  USR_ID        NUMBER(11)
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE TABLE NODE_TAGS
(
  NODE_ID  NUMBER(11)                           NOT NULL,
  KEY      VARCHAR2(255 BYTE)                   NOT NULL,
  VALUE    VARCHAR2(255 BYTE)
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE TABLE WAY
(
  ID            NUMBER(11)                      NOT NULL,
  CHANGESET_ID  NUMBER(11)                      NOT NULL,
  TIMESTAMP     DATE                            NOT NULL,
  VISIBLE       NUMBER(1)                       NOT NULL,
  VERSION       NUMBER(11)                      NOT NULL,
  USR           VARCHAR2(255 BYTE),
  USR_ID        NUMBER(11)
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE TABLE WAY_TAGS
(
  WAY_ID  NUMBER(11)                            NOT NULL,
  KEY     VARCHAR2(255 BYTE)                    NOT NULL,
  VALUE   VARCHAR2(255 BYTE)
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE TABLE WAY_NODES
(
  WAY_ID       NUMBER(11)                       NOT NULL,
  NODE_ID      NUMBER(11)                       NOT NULL,
  SEQUENCE_ID  NUMBER(11)                       NOT NULL
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE TABLE RELATION
(
  ID            NUMBER(11)                      NOT NULL,
  CHANGESET_ID  NUMBER(11)                      NOT NULL,
  TIMESTAMP     DATE                            NOT NULL,
  VISIBLE       NUMBER(1)                       NOT NULL,
  VERSION       NUMBER(11)                      NOT NULL,
  USR           VARCHAR2(255 BYTE),
  USR_ID        NUMBER(11)
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE TABLE RELATION_TAGS
(
  RELATION_ID  NUMBER(11)                       NOT NULL,
  KEY          VARCHAR2(255 BYTE)               NOT NULL,
  VALUE        VARCHAR2(255 BYTE)
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE TABLE RELATION_MEMBERS
(
  RELATION_ID  NUMBER(11)                       NOT NULL,
  MEMBER_TYPE  VARCHAR2(20 BYTE)                NOT NULL,
  MEMBER_ID    NUMBER(11)                       NOT NULL,
  MEMBER_ROLE  VARCHAR2(255 BYTE),
  SEQUENCE_ID  NUMBER(11)                       NOT NULL
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE UNIQUE INDEX NODE_PK ON NODE
(ID)
LOGGING
NOPARALLEL;


CREATE INDEX NODE_TILE_IDX ON NODE
(TILE)
LOGGING
NOPARALLEL;


CREATE INDEX NODE_TAGS_IDX ON NODE_TAGS
(NODE_ID)
LOGGING
NOPARALLEL;


CREATE UNIQUE INDEX RELATION_PK ON RELATION
(ID)
LOGGING
NOPARALLEL;


CREATE INDEX RELATION_MEMBERS_IDX ON RELATION_MEMBERS
(RELATION_ID)
LOGGING
NOPARALLEL;


CREATE INDEX RELATION_MEMBERS_MEMBER_IDX ON RELATION_MEMBERS
(MEMBER_ID, MEMBER_TYPE)
LOGGING
NOPARALLEL;


CREATE INDEX RELATION_TAGS_IDX ON RELATION_TAGS
(RELATION_ID)
LOGGING
NOPARALLEL;


CREATE UNIQUE INDEX WAY_PK ON WAY
(ID)
LOGGING
NOPARALLEL;


CREATE INDEX WAY_NODES_IDX ON WAY_NODES
(WAY_ID)
LOGGING
NOPARALLEL;


CREATE INDEX WAY_NODES_NODE_IDX ON WAY_NODES
(NODE_ID)
LOGGING
NOPARALLEL;


CREATE INDEX WAY_TAGS_IDX ON WAY_TAGS
(WAY_ID)
LOGGING
NOPARALLEL;


ALTER TABLE NODE ADD (
  CONSTRAINT NODE_PK
 PRIMARY KEY
 (ID));

ALTER TABLE WAY ADD (
  CONSTRAINT WAY_PK
 PRIMARY KEY
 (ID));

ALTER TABLE RELATION ADD (
  CONSTRAINT RELATION_PK
 PRIMARY KEY
 (ID));

ALTER TABLE NODE_TAGS ADD (
  CONSTRAINT NODE_TAGS_R01 
 FOREIGN KEY (NODE_ID) 
 REFERENCES NODE (ID));

ALTER TABLE WAY_TAGS ADD (
  CONSTRAINT WAY_TAGS_R01 
 FOREIGN KEY (WAY_ID) 
 REFERENCES WAY (ID));

ALTER TABLE WAY_NODES ADD (
  CONSTRAINT WAY_NODES_R01 
 FOREIGN KEY (WAY_ID) 
 REFERENCES WAY (ID),
  FOREIGN KEY (NODE_ID) 
 REFERENCES NODE (ID));

ALTER TABLE RELATION_TAGS ADD (
  CONSTRAINT RELATION_TAGS_R01 
 FOREIGN KEY (RELATION_ID) 
 REFERENCES RELATION (ID));

ALTER TABLE RELATION_MEMBERS ADD (
  CONSTRAINT RELATION_MEMBERS_R01 
 FOREIGN KEY (RELATION_ID) 
 REFERENCES RELATION (ID));


